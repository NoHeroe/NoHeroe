<!DOCTYPE html><html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NoHeroes | Loja Mobile v2</title>
  <link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --roxo:#a855f7; --roxo-600:#9333ea; --roxo-300:#c084fc;
      --dourado:#facc15; --cinza:#1b1b1b; --fundo:#0a0a0a; --claro:#f4f4f4; --borda:#2b2b2b;
    }
    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100%}
    body{
      font-family:'Unbounded',system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Open Sans',sans-serif;
      background:radial-gradient(1200px 800px at 70% -10%, rgba(168,85,247,.12), transparent 60%) , var(--fundo);
      color:var(--claro);
      overflow-x:hidden;
    }/* ===== Layout ===== */
.app{display:flex;min-height:100dvh}
.nav-lateral{
  width:86px;flex:0 0 86px;background:linear-gradient(180deg,#101010,#151515);
  border-right:1px solid var(--borda);position:sticky;top:0;height:100dvh;z-index:20
}
.nav-lateral .logo{
  display:flex;align-items:center;justify-content:center;height:66px;border-bottom:1px solid var(--borda)
}
.nav-lateral .logo img{width:46px;filter:drop-shadow(0 0 6px #a855f7)}
.nav-menu{display:flex;flex-direction:column}
.nav-btn{appearance:none;background:none;border:0;color:#9ca3af;cursor:pointer;padding:.9rem .4rem;border-bottom:1px solid var(--borda);font-size:.8rem;letter-spacing:.02em}
.nav-btn:hover{background:#0f0f0f;color:#d1d5db}
.nav-btn.ativo{background:linear-gradient(90deg, rgba(168,85,247,.18), transparent);color:var(--roxo);font-weight:700;box-shadow:inset 3px 0 0 var(--roxo)}

main{
  flex:1;min-width:0;position:relative
}

/* Topbar + Cart */
.topbar{position:sticky;top:0;z-index:30;backdrop-filter:blur(8px);background:rgba(10,10,10,.6);border-bottom:1px solid var(--borda)}
.topbar-inner{display:flex;align-items:center;justify-content:space-between;gap:1rem;padding:.8rem 1rem}
.titulo{font-size:1.05rem;color:var(--roxo);text-shadow:0 0 8px rgba(168,85,247,.45)}
.cart-btn{position:relative;display:inline-flex;align-items:center;justify-content:center;width:44px;height:44px;border-radius:10px;background:rgba(0,0,0,.7);border:1px solid var(--roxo);box-shadow:0 0 12px rgba(168,85,247,.45);cursor:pointer}
.cart-btn:hover{box-shadow:0 0 16px rgba(168,85,247,.7)}
.cart-btn img{width:22px;height:22px;filter:drop-shadow(0 0 6px var(--roxo))}
.cart-badge{position:absolute;top:-6px;right:-6px;background:#ef4444;color:white;border-radius:999px;font-size:.7rem;padding:2px 6px;line-height:1}

/* Seções */
.sections{scroll-behavior:smooth}
section{min-height:100dvh;padding:2rem 1rem;display:grid;place-items:center;position:relative}
.bloco{width:min(880px,92vw);margin-inline:auto}
.bloco header{text-align:center;margin-bottom:1rem}
.bloco h2{font-size:1.3rem;color:var(--roxo);text-shadow:0 0 10px var(--roxo)}
.lead{opacity:.85;max-width:36ch;margin:.5rem auto 0;text-align:center}

/* Product Rail (um card por categoria – swipe / arrows) */
.rail{position:relative;display:flex;align-items:center;justify-content:center}
.card{position:relative;display:block;width:min(360px,92vw);background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:1rem;box-shadow:0 0 18px rgba(168,85,247,.18);backdrop-filter:blur(12px);transition:transform .25s ease}
.card:hover{transform:translateY(-2px)}
.card img{width:100%;aspect-ratio:4/3;object-fit:cover;border-radius:10px;margin:.5rem 0}
.card h3{font-size:1.1rem;margin-bottom:.25rem}
.rarity{font-size:.85rem;color:var(--roxo);font-weight:700;margin-bottom:.35rem}
.price{display:flex;gap:.5rem;align-items:baseline;margin:.35rem 0}
.price .brl,.price .coin{color:var(--dourado);font-weight:800}
.actions{display:grid;gap:.5rem}
.btn{--bg:var(--roxo);--fg:#0a0a0a;appearance:none;border:1px solid var(--roxo);background:var(--bg);color:var(--fg);font-weight:800;border-radius:10px;padding:.6rem 1rem;cursor:pointer}
.btn.secondary{--bg:transparent;--fg:var(--roxo)}
.btn:disabled{opacity:.55;cursor:not-allowed}

.badge{position:absolute;top:.6rem;left:.6rem;background:var(--roxo);color:#0a0a0a;font-weight:800;font-size:.75rem;padding:.2rem .45rem;border-radius:6px}

.nav-arrow{position:absolute;top:50%;transform:translateY(-50%);background:rgba(0,0,0,.4);border:0;color:white;font-size:1.6rem;border-radius:10px;padding:.4rem .6rem;cursor:pointer}
.nav-arrow:hover{background:rgba(168,85,247,.65)}
.arrow-prev{left:-.25rem} .arrow-next{right:-.25rem}
@media(max-width:768px){.nav-arrow{display:none}}

/* Cart panel */
.cart-panel{position:fixed;right:1rem;top:66px;width:min(320px,92vw);background:#0b0b0b;border:1px solid var(--roxo);border-radius:12px;box-shadow:0 0 22px rgba(168,85,247,.35);padding:1rem;z-index:50;display:none}
.cart-panel.open{display:block}
.cart-title{font-size:1rem;color:#fff;margin-bottom:.7rem}
.cart-list{display:grid;gap:.6rem;max-height:260px;overflow:auto}
.cart-item{display:grid;grid-template-columns:44px 1fr auto;gap:.6rem;align-items:center;background:rgba(0,0,0,.55);border:1px solid var(--roxo);border-radius:10px;padding:.5rem}
.cart-item img{width:44px;height:44px;border-radius:8px;object-fit:cover}
.cart-item .name{font-size:.9rem}
.cart-item .meta{font-size:.78rem;opacity:.7}
.cart-item .rm{appearance:none;background:none;border:0;color:#f87171;font-size:1.1rem;cursor:pointer}
.cart-total{margin-top:.6rem;border-top:1px solid var(--borda);padding-top:.6rem}
.cart-total .line{display:flex;justify-content:space-between;margin:.2rem 0}
.cart-total .withfee{color:var(--roxo);text-shadow:0 0 4px var(--roxo)}
.pay-select, .input{width:100%;background:#000;border:1px solid var(--roxo);border-radius:8px;color:#fff;padding:.5rem;font-size:.9rem;margin:.4rem 0}

/* Info drawer */
.info{position:fixed;inset:auto 0 0 auto;width:min(360px,92vw);height:95dvh;background:#0a0a0a;border-left:2px solid var(--roxo);box-shadow:-2px 0 12px var(--roxo);padding:1rem;transform:translateX(100%);transition:transform .35s ease;z-index:60;overflow:auto}
.info.open{transform:translateX(0)}
.info h3{color:var(--roxo);margin-bottom:.6rem}
.info img{width:100%;border-radius:10px;margin:.5rem 0}
.info p{font-size:.9rem;line-height:1.45;color:#d1d5db}
.info .close{position:absolute;top:.6rem;right:.6rem;appearance:none;background:none;border:0;color:#f87171;font-size:1.4rem;cursor:pointer}

/* Brasas Canvas */
#brasasCanvas{position:fixed;inset:0;z-index:-1;pointer-events:none}
html{-webkit-tap-highlight-color:transparent}

  </style>
</head>
<body>
  <!-- Background -->
  <canvas id="brasasCanvas" aria-hidden="true"></canvas>  <div class="app">
    <!-- Nav -->
    <aside class="nav-lateral" role="navigation" aria-label="Seções da loja">
      <div class="logo"><img src="assets/images/logo noheroes.png" alt="NoHeroes"></div>
      <nav class="nav-menu">
        <button class="nav-btn ativo" data-idx="0">Início</button>
        <button class="nav-btn" data-idx="1">Mangás</button>
        <button class="nav-btn" data-idx="2">Animes</button>
        <button class="nav-btn" data-idx="3">Ebooks</button>
        <button class="nav-btn" data-idx="4">Mentorias</button>
        <button class="nav-btn" data-idx="5">Extras</button>
      </nav>
    </aside><!-- Main -->
<main>
  <div class="topbar">
    <div class="topbar-inner">
      <div class="titulo">Loja NoHeroes</div>
      <button id="btnCart" class="cart-btn" aria-haspopup="true" aria-controls="cartPanel" aria-expanded="false">
        <img src="assets/icons/cart.png" alt="Carrinho">
        <span id="cartBadge" class="cart-badge">0</span>
      </button>
    </div>
  </div>

  <div class="sections">
    <!-- Início -->
    <section id="sec-0">
      <div class="bloco">
        <header>
          <h2>Bem-vindo à Loja</h2>
          <p class="lead">Explore itens, conteúdos e experiências do universo <strong>NoHeroes</strong> – roxo x dourado, brasas e muito estilo.</p>
        </header>
      </div>
    </section>

    <!-- Categorias -->
    <section id="sec-1"><div class="bloco"><header><h2>Mangás</h2></header><div class="rail"><button class="nav-arrow arrow-prev" data-cat="Mangá">‹</button><article id="card-Mangá" class="card" aria-live="polite"></article><button class="nav-arrow arrow-next" data-cat="Mangá">›</button></div></div></section>
    <section id="sec-2"><div class="bloco"><header><h2>Animes</h2></header><div class="rail"><button class="nav-arrow arrow-prev" data-cat="Anime">‹</button><article id="card-Anime" class="card" aria-live="polite"></article><button class="nav-arrow arrow-next" data-cat="Anime">›</button></div></div></section>
    <section id="sec-3"><div class="bloco"><header><h2>Ebooks</h2></header><div class="rail"><button class="nav-arrow arrow-prev" data-cat="Ebook">‹</button><article id="card-Ebook" class="card" aria-live="polite"></article><button class="nav-arrow arrow-next" data-cat="Ebook">›</button></div></div></section>
    <section id="sec-4"><div class="bloco"><header><h2>Mentorias</h2></header><div class="rail"><button class="nav-arrow arrow-prev" data-cat="Mentoria">‹</button><article id="card-Mentoria" class="card" aria-live="polite"></article><button class="nav-arrow arrow-next" data-cat="Mentoria">›</button></div></div></section>
    <section id="sec-5"><div class="bloco"><header><h2>Extras</h2></header><div class="rail"><button class="nav-arrow arrow-prev" data-cat="Extras">‹</button><article id="card-Extras" class="card" aria-live="polite"></article><button class="nav-arrow arrow-next" data-cat="Extras">›</button></div></div></section>
  </div>
</main>

  </div>  <!-- Cart Panel -->  <aside id="cartPanel" class="cart-panel" role="dialog" aria-modal="false" aria-labelledby="cartTitle">
    <h3 id="cartTitle" class="cart-title">Seu carrinho</h3>
    <div id="cartList" class="cart-list"></div>
    <div class="cart-total">
      <div class="line"><span>Subtotal</span><span id="cartSubtotal">R$ 0,00</span></div>
      <select id="payMethod" class="pay-select" aria-label="Método de pagamento">
        <option value="">Selecione...</option>
        <option value="mercadopago">Mercado Pago (4,99%)</option>
        <option value="paypal">PayPal (4,79% + R$0,60)</option>
        <option value="moeda">Moeda Interna (0%)</option>
      </select>
      <div class="line withfee"><span>Total com taxa</span><span id="cartWithFee">R$ 0,00</span></div>
      <div id="payAction"></div>
    </div>
  </aside>  <!-- Info Drawer -->  <aside id="infoDrawer" class="info" role="dialog" aria-modal="false" aria-labelledby="infoTitle">
    <button class="close" id="infoClose" aria-label="Fechar">✕</button>
    <h3 id="infoTitle"></h3>
    <img id="infoImg" alt="">
    <p id="infoDesc"></p>
  </aside>  <script>
  // ===== Auth redirect (mantém comportamento, mas evita canvas no <head>) =====
  (function(){
  const token = localStorage.getItem('NoHeroes_token');
  if(!token){
    console.warn('⚠️ Token ausente (mas sem redirect nesta versão de teste)');
    window.tokenJWT = null; // deixa seguir sem travar
  } else {
    window.tokenJWT = token;
  }
})();

  // ===== Helpers =====
  const fmtBRL = n => (n||0).toLocaleString('pt-BR',{style:'currency',currency:'BRL'});
  const taxas = { mercadopago:0.0499, paypalPerc:0.0479, paypalFixo:0.60, moeda:0 };
  const withFee = (subtotal, m) => m==='mercadopago'? subtotal*(1+taxas.mercadopago) : m==='paypal'? subtotal*(1+taxas.paypalPerc)+taxas.paypalFixo : subtotal;

  const CARD_IDS = { 'Mangá':'card-Mangá','Anime':'card-Anime','Ebook':'card-Ebook','Mentoria':'card-Mentoria','Extras':'card-Extras' };
  const SECTIONS = ['sec-0','sec-1','sec-2','sec-3','sec-4','sec-5'];

  let produtos = { 'Mangá':[], 'Anime':[], 'Ebook':[], 'Mentoria':[], 'Extras':[] };
  let idx = { 'Mangá':0, 'Anime':0, 'Ebook':0, 'Mentoria':0, 'Extras':0 };
  let cart = [];

  // ===== UI bindings =====
  const qs = s=>document.querySelector(s);
  const qsa=s=>[...document.querySelectorAll(s)];
  const btnCart = qs('#btnCart'); const cartPanel=qs('#cartPanel');
  const cartBadge=qs('#cartBadge'); const cartList=qs('#cartList');
  const cartSubtotal=qs('#cartSubtotal'); const cartWithFee=qs('#cartWithFee');
  const payMethod=qs('#payMethod'); const payAction=qs('#payAction');
  const infoDrawer=qs('#infoDrawer'); const infoClose=qs('#infoClose');

  // Nav lateral → rolagem suave
  qsa('.nav-btn').forEach(b=>b.addEventListener('click',()=>{
    const i = Number(b.dataset.idx); qsa('.nav-btn').forEach(x=>x.classList.toggle('ativo',x===b));
    document.getElementById(SECTIONS[i]).scrollIntoView({behavior:'smooth'});
  }));

  // Setas
  qsa('.nav-arrow').forEach(el=>{
    el.addEventListener('click',()=> navigate(el.dataset.cat, el.classList.contains('arrow-next')? +1 : -1));
  });

  // Carrinho toggle
  btnCart.addEventListener('click',()=>{
    cartPanel.classList.toggle('open');
    btnCart.setAttribute('aria-expanded', cartPanel.classList.contains('open'));
    renderCart();
  });

  payMethod.addEventListener('change',()=>{ renderCartTotals(); renderPayCTA(); });

  // Drawer Info
  infoClose.addEventListener('click',()=> infoDrawer.classList.remove('open'));

  // ===== Data load =====
  async function loadProducts(){
    try{
      const res = await fetch('https://api.noheroes.com.br/shop');
      const json = await res.json();
      (json.data||[]).forEach(p=>{
        const cat = normalizeCat(p.category);
        if(cat && produtos[cat]) produtos[cat].push(p);
      });
      renderAllCards();
      attachSwipe();
    }catch(e){
      console.error('Erro ao carregar produtos', e);
      // estados vazios
      Object.keys(CARD_IDS).forEach(cat=>{
        const c = document.getElementById(CARD_IDS[cat]);
        if(c) c.innerHTML = `<div style="text-align:center;opacity:.8;padding:.8rem">Falha ao carregar. <button class='btn secondary' onclick='location.reload()'>Tentar novamente</button></div>`;
      });
    }
  }

  function normalizeCat(c){
    if(!c) return '';
    const k = String(c).toLowerCase();
    if(k.startsWith('mang')) return 'Mangá';
    if(k.startsWith('ani')) return 'Anime';
    if(k.startsWith('ebo')) return 'Ebook';
    if(k.startsWith('men')) return 'Mentoria';
    if(k.startsWith('ext')) return 'Extras';
    return '';
  }

  // ===== Cards =====
  function renderAllCards(){
    Object.keys(CARD_IDS).forEach(cat=> renderCard(cat));
  }

  function renderCard(cat){
    const list = produtos[cat]; const i = idx[cat] % Math.max(list.length,1); const c = document.getElementById(CARD_IDS[cat]);
    if(!c) return;
    if(!list.length){ c.innerHTML = `<div style="text-align:center;opacity:.8;padding:1rem">Sem itens nesta categoria.</div>`; return; }

    const p = list[i];
    const emBreve = /em\s*_?breve/i.test(String(p.status||''));
    const priceParts = [];
    if(p.priceReal) priceParts.push(`<span class='brl'>${fmtBRL(Number(p.priceReal))}</span>`);
    if(p.priceCoins) priceParts.push(`<span class='coin'>${p.priceCoins} ✪</span>`);
    const priceHTML = priceParts.length? priceParts.join(' / ') : `<span class='brl'>Gratuito</span>`;

    const safeDesc = String(p.description||'Sem descrição.').replace(/`/g,"'").replace(/\\/g,'\\\\');

    c.innerHTML = `
      ${emBreve?`<span class='badge'>EM BREVE</span>`:''}
      <button class='btn secondary' style='position:absolute;top:.6rem;right:.6rem' aria-label='Mais informações' onclick="showInfo(\`${p.name}\`,\`${p.imageUrl||p.image||''}\`,\`${safeDesc}\`)">i</button>
      <img src='${p.imageUrl||p.image||''}' alt='${p.name}'>
      <h3>${p.name}</h3>
      <div class='rarity'>${p.rarity||''}</div>
      <div class='price'>${priceHTML}</div>
      <div class='actions'>
        <button class='btn' ${emBreve? 'disabled' : ''} onclick="addToCart('${p.id}')">${emBreve? 'Em breve' : 'Adicionar ao carrinho'}</button>
      </div>
    `;
  }

  function attachSwipe(){
    Object.keys(CARD_IDS).forEach(cat=>{
      const el = document.getElementById(CARD_IDS[cat]); if(!el) return;
      let sx=0, ex=0; el.addEventListener('touchstart',e=> sx=e.changedTouches[0].screenX,{passive:true});
      el.addEventListener('touchend',e=>{ ex=e.changedTouches[0].screenX; if(ex<sx-30) navigate(cat, +1); else if(ex>sx+30) navigate(cat,-1); },{passive:true});
    });
  }

  function navigate(cat, step){
    const list = produtos[cat]||[]; if(!list.length) return;
    idx[cat] = (idx[cat] + step + list.length) % list.length;
    renderCard(cat);
  }

  // ===== Cart =====
  function addToCart(id){
    const p = Object.values(produtos).flat().find(x=> String(x.id)===String(id));
    if(!p) return;
    const existing = cart.find(x=> String(x.id)===String(id));
    if(existing) existing.quantity += 1; else cart.push({ id:p.id, name:p.name, imageUrl:p.imageUrl||p.image||'', priceReal:Number(p.priceReal||p.price||0), quantity:1 });
    renderCart();
  }
  function removeFromCart(id){ cart = cart.filter(x=> String(x.id)!==String(id)); renderCart(); }

  function renderCart(){
    cartList.innerHTML='';
    let subtotal=0;
    cart.forEach(i=>{ subtotal += (i.priceReal||0)*i.quantity; cartList.insertAdjacentHTML('beforeend', `
      <div class='cart-item'>
        <img src='${i.imageUrl}' alt='${i.name}'>
        <div>
          <div class='name'>${i.name}</div>
          <div class='meta'>${i.quantity}× ${fmtBRL(i.priceReal||0)}</div>
        </div>
        <button class='rm' aria-label='Remover' onclick="removeFromCart('${i.id}')">×</button>
      </div>`);
    });
    cartBadge.textContent = String(cart.reduce((s,i)=>s+i.quantity,0));
    cartSubtotal.textContent = fmtBRL(subtotal);
    renderCartTotals();
    renderPayCTA();
  }

  function renderCartTotals(){
    const subtotal = parseBRL(cartSubtotal.textContent);
    cartWithFee.textContent = fmtBRL(withFee(subtotal, payMethod.value));
  }

  function renderPayCTA(){
    const m = payMethod.value; const labels={mercadopago:'Pagar com Mercado Pago',paypal:'Pagar com PayPal',moeda:'Pagar com Moeda'};
    payAction.innerHTML = m? `<button class='btn' id='btnCheckout'>${labels[m]}</button>` : '';
    const btn = document.getElementById('btnCheckout'); if(btn) btn.addEventListener('click', checkout);
  }

  function parseBRL(s){
    return Number(String(s||'0').replace(/R\$\s?/,'').replace(/\./g,'').replace(',', '.'))||0;
  }

  async function checkout(){
    if(!cart.length){ alert('Seu carrinho está vazio.'); return; }
    const method = payMethod.value; if(!method){ alert('Selecione um método de pagamento.'); return; }

    const token = localStorage.getItem('NoHeroes_token')||'';
    let email='';
    try{ email = JSON.parse(atob(token.split('.')[1])).email || ''; }catch{ }
    if(!email){ alert('Não consegui obter seu e-mail. Faça login novamente.'); return; }

    const btn = document.getElementById('btnCheckout'); if(btn){ btn.disabled=true; btn.textContent='Processando...'; }

    try{
      if(method==='mercadopago'){
        const items = cart.map(i=>({ id:i.id, name:i.name, imageUrl:i.imageUrl, quantity:i.quantity, priceComTaxa: Number(withFee(i.priceReal||0,'mercadopago').toFixed(2)) }));
        const body = { items, email };
        const res = await fetch('https://api.noheroes.com.br/criar-pagamento', { method:'POST', headers:{ 'Content-Type':'application/json', Authorization:`Bearer ${token}` }, body:JSON.stringify(body)});
        const data = await res.json(); if(!res.ok) throw new Error(data.error||'Erro no servidor');
        location.href = data.init_point; return;
      }

      // PayPal & Moeda
      const subtotal = parseBRL(cartSubtotal.textContent);
      const totalWithFee = withFee(subtotal, method);
      const body2 = { items: cart.map(i=>({id:i.id, quantity:i.quantity})), totalWithFee, ...(method==='moeda'? {useCoins:true}: {}) };
      const res2 = await fetch('https://api.noheroes.com.br/criar-pagamento', { method:'POST', headers:{ 'Content-Type':'application/json', Authorization:`Bearer ${token}` }, body:JSON.stringify(body2)});
      const data2 = await res2.json(); if(!res2.ok) throw new Error(data2.error||'Erro ao finalizar compra.');
      alert('✅ Compra finalizada com sucesso!'); cart=[]; renderCart();
    }catch(e){ alert('❌ '+ e.message); }
    finally{ if(btn){ btn.disabled=false; renderPayCTA(); } }
  }

  // ===== Info Drawer =====
  function showInfo(nome,img,desc){
    document.getElementById('infoTitle').textContent = nome;
    document.getElementById('infoImg').src = img;
    document.getElementById('infoImg').alt = nome;
    document.getElementById('infoDesc').textContent = desc;
    infoDrawer.classList.add('open');
  }
  window.showInfo = showInfo; // usado no HTML inline dos cards

  // ===== Brasas =====
  const cvs=document.getElementById('brasasCanvas'); const ctx=cvs.getContext('2d'); let W=0,H=0,parts=[];
  function resize(){ W=cvs.width=innerWidth; H=cvs.height=innerHeight; }
  addEventListener('resize', resize, {passive:true}); resize();
  class Part{ constructor(init=false){ this.reset(init);} reset(init){ this.x=Math.random()*W; this.y=init? Math.random()*H : H+Math.random()*80; this.r=1+Math.random()*2.5; this.vy=0.25+Math.random()*0.5; this.vx=(Math.random()-.5)*.5; this.a=.35+Math.random()*.35; }
    up(){ this.y-=this.vy; this.x+=this.vx; if(this.y<-10||this.x<-50||this.x>W+50) this.reset(); }
    draw(){ ctx.beginPath(); ctx.arc(this.x,this.y,this.r,0,Math.PI*2); ctx.fillStyle=`rgba(168,85,247,${this.a})`; ctx.shadowColor='#a855f7'; ctx.shadowBlur=12; ctx.fill(); }
  }
  function spawn(n){ for(let i=0;i<n;i++) parts.push(new Part(true)); }
  function loop(){ ctx.clearRect(0,0,W,H); for(const p of parts){ p.up(); p.draw(); } requestAnimationFrame(loop); }
  spawn(140); loop();

  // ===== Boot =====
  (async function init(){
    // Preload e-mail (silencioso)
    try{
      const raw = localStorage.getItem('NoHeroes_token')||'';
      if(raw){ await fetch('https://api.noheroes.com.br/user/me',{ headers:{ Authorization:`Bearer ${raw}` }}); }
    }catch{}
    await loadProducts();
  })();
  </script></body>
</html>